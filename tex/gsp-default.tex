%GregorioTeX file.
%Copyright (C) 2007-2010 Elie Roux <elie.roux@telecom-bretagne.eu>
%
%This program is free software: you can redistribute it and/or modify
%it under the terms of the GNU General Public License as published by
%the Free Software Foundation, either version 3 of the License, or
%(at your option) any later version.
%
%This program is distributed in the hope that it will be useful,
%but WITHOUT ANY WARRANTY; without even the implied warranty of
%MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%GNU General Public License for more details.
%
%You should have received a copy of the GNU General Public License
%along with this program.  If not, see <http://www.gnu.org/licenses/>.

% this file contains definitions of spaces and penalties

%% First, the penalties

% penalty at the end of a syllable which is the end of a word
\xdef\greendofwordpenalty{-100}
% penalty at the end of a syllable which is not the end of a word
\xdef\greendofsyllablepenalty{-50}
% penalty at the end of a syllable which is just a bar, with something printed
% under it
\xdef\greendafterbarpenalty{-200}
% penalty right after a bar with nothing printed
\xdef\greendafterbaraltpenalty{-200}
% penalty at the end of a breakable neumatic element (typically at a space
% between elements)
\xdef\greendofelementpenalty{-50}
% hyphenpenalty will be used in discretionaries, in Gregorio this is used for
% a bar with clef change for example. It also set \exhyphenpenalty. It should
% be close to \greendafterbarpenalty
\xdef\grehyphenpenalty{-200}

% broken penalty is the vertical penalty inserted after a break on a clef change
% I'm not sure it should be set, but it might be useful...
\xdef\grebrokenpenalty{0}

%% Then, some fine tunings
\def\grelooseness{\looseness}
\def\gretolerance{9000}
% Workaround for bug 842 (http://tracker.luatex.org/view.php?id=842)
% see http://tug.org/pipermail/luatex/2013-July/004516.html
\ifnum\the\luatexversion < 78\relax %
  \global\def\grepretolerance{-1}
\else %
  \global\def\grepretolerance{\pretolerance}
\fi %
\def\greemergencystretch{\emergencystretch}
% By default, we don't care if a line of score is alone on the page,
% if you think it is bad, you can modify the two following values. Assigning
% 10000 to them will prevent all orphaned lines (this will certainly improve
% some spacings a lot).
\def\grewidowpenalty{0}
\def\greclubpenalty{0}



%%%%%%%%%%%%%%%%%%
%% And finally, all the spacings:
%%%%%%%%%%%%%%%%%%

%This count tells gregoriotex what \grefactor the below values correspond to.
%% All the following values correspond to a grefactor of 17.  At this size the scores should be approximately the size usually seen in a gradual.
%% If youâ€™re creating your own space configuration file, you may set this to some other value, should you so desire.
\newcount\greconffactor
\greconffactor=17

% the additional width of the additional lines (compared to the width of the glyph they're associated with)
\gresetdim{additionallineswidth}{0.14584 cm}{1}
% width of the additional lines, used only for the custos (maybe should depend on the width of the custo...)
% the width is the one for the custos at end of lines, the line for custos in the middle of a score is the same
% multiplied by 2.
\gresetdim{additionalcustoslineswidth}{0.09114 cm}{1}
% null space
\gresetdim{zerowidthspace}{0 cm}{1}
% space between glyphs in the same element
\gresetdim{interglyphspace}{0.06927 cm plus 0.00363 cm minus 0.00363 cm}{1}
% space between an alteration (flat or natural) and the next glyph
\gresetdim{alterationspace}{0.07747 cm plus 0.01276 cm minus 0.00455 cm}{1}
% space between a clef and a flat (for clefs with flat)
\gresetdim{clefflatspace}{0.05469 cm plus 0.00638 cm minus 0.00638 cm}{1}
% space before a choral sign
\gresetdim{beforechoralsignspace}{0.04556 cm plus 0.00638 cm minus 0.00638 cm}{1}
% negative space, difference between the normal space between two notes and the space between a note and a flat
\gresetdim{beforealterationspace}{-0.32816 cm plus 0.01093 cm minus 0.01093 cm}{1}
% space between elements
\gresetdim{interelementspace}{0.06927 cm plus 0.00182 cm minus 0.00363 cm}{1}
% larger space between elements
\gresetdim{largerspace}{0.10938 cm plus 0.01822 cm minus 0.00911 cm}{1}
% space between elements which has the size of a note
\gresetdim{glyphspace}{0.21877 cm plus 0.01822 cm minus 0.01822 cm}{1}
% minimum space between two notes of different syllables
\gresetdim{intersyllablespace}{0.25523 cm plus 0.31903 cm minus 0 cm}{1}
% space before custo
\gresetdim{spacebeforecusto}{0.1823 cm plus 0.31903 cm minus 0.0638 cm}{1}
% space before punctum mora and augmentum duplex
\gresetdim{spacebeforesigns}{0.05469 cm plus 0.00455 cm minus 0.00455 cm}{1}
% space after punctum mora and augmentum duplex
\gresetdim{spaceaftersigns}{0.08203 cm plus 0.0082 cm minus 0.0082 cm}{1}
% space after a clef at the beginning of a line
\gresetdim{spaceafterlineclef}{0.27345 cm plus 0.14584 cm minus 0.01367 cm}{1}
% space after at the end of a word when the last written symbol is a note and the first is a note
\gresetdim{interwordspacenotes}{0.29169 cm plus 0.08751 cm minus 0.05469 cm}{1}
% space after at the end of a word when the last written symbol is a note and the first is text
\gresetdim{interwordspacenotestext}{0.27345 cm plus 0.27345 cm minus 0.07292 cm}{1}
% space after at the end of a word when the last written symbol is text and the first is a note
\gresetdim{interwordspacetextnotes}{0.27345 cm plus 0.27345 cm minus 0.07292 cm}{1}
% space after at the end of a word when the last written symbol is text and the first is text
\gresetdim{interwordspacetext}{0.22787 cm plus 0.41019 cm minus 0.07292 cm}{1}
% space between notes of a bivirga or trivirga
\gresetdim{bitrivirspace}{0.06927 cm plus 0.00182 cm minus 0.00546 cm}{1}
% space between notes of a bistropha or tristrophae
\gresetdim{bitristrospace}{0.06927 cm plus 0.00182 cm minus 0.00546 cm}{1}
% space between two punctum inclinatum
\gresetdim{punctuminclinatumshift}{-0.03918 cm plus 0.0009 cm minus 0.0009 cm}{1}
% space before puncta inclinata
\gresetdim{beforepunctainclinatashift}{0.05286 cm plus 0.00728 cm minus 0.00455 cm}{1}
% space between a punctum inclinatum and a punctum inclinatum deminutus
\gresetdim{punctuminclinatumanddebilisshift}{-0.02278 cm plus 0.0009 cm minus 0.0009 cm}{1}
% space between two punctum inclinatum deminutus
\gresetdim{punctuminclinatumdebilisshift}{-0.00728 cm plus 0.0009 cm minus 0.0009 cm}{1}
% space between puncta inclinata, larger ambitus (range=3rd)
\gresetdim{punctuminclinatumbigshift}{0.07565 cm plus 0.0009 cm minus 0.0009 cm}{1}
% space between puncta inclinata, larger ambitus (range=4th -or more?-)
\gresetdim{punctuminclinatummaxshift}{0.17865 cm plus 0.0009 cm minus 0.0009 cm}{1}
% space for the bars (inside syllables)
%first for virgula and divisio minima
\gresetdim{spacearoundsmallbar}{0.1823 cm plus 0.22787 cm minus 0.05469 cm}{1}
%then divisio minor
\gresetdim{spacearoundminor}{0.1823 cm plus 0.22787 cm minus 0.05469 cm}{1}
%divisio major
\gresetdim{spacearoundmaior}{0.1823 cm plus 0.22787 cm minus 0.05469 cm}{1}
%divisio finalis
\gresetdim{spacearoundfinalis}{0.1823 cm plus 0.22787 cm minus 0.05469 cm}{1}
%a special space for finalis, for when it is the last glyph
\gresetdim{spacebeforefinalfinalis}{0.29169 cm plus 0.07292 cm minus 0.27345 cm}{1}
% additional space that will appear around bars that are preceded by a custo and followed by a key.
\gresetdim{spacearoundclefbars}{0.03645 cm plus 0.00455 cm minus 0.0009 cm}{1}
% space between the text and the text of the bar
\gresetdim{textbartextspace}{0.24611 cm plus 0.13672 cm minus 0.04921 cm}{1}
% minimal space between a note and a bar
\gresetdim{notebarspace}{0.31903 cm plus 0.27345 cm minus 0.02824 cm}{1}
% maximal space between two syllables for which we consider a dash is not needed
\gresetdim{maximumspacewithoutdash}{0.02005 cm}{1}
% an extensible space for the beginning of lines
\gresetdim{afterclefnospace}{0 cm plus 0.27345 cm minus 0 cm}{1}
% space between the initial and the beginning of the score
\gresetdim{afterinitialshift}{0.2457 cm}{1}
% space before the initial
\gresetdim{beforeinitialshift}{0.2457 cm}{1}
% minimum space before each line (except those preceded by the initial)
\gresetdim{minimalspaceatlinebeginning}{0.1 cm}{1}
% space to force the initial width to.  Ignored when 0.
\gresetdim{manualinitialwidth}{0 cm}{1}
% this space is the one between the bottom of the first anotation line and the top
% of the second anotation line (above the initial)
\gresetdim{aboveinitialseparation}{0.05 cm}{1}
% space at the beginning of the lines if there is no clef
\gresetdim{noclefspace}{0.1 cm}{1}
% space around a clef change
\gresetdim{clefchangespace}{0.01768 cm plus 0.00175 cm minus 0.01768 cm}{1}%
%When \gre@clivisalignment is 2, this distance is the maximum length of the consonants after vowels for which the clivis will be aligned on its center.
\gresetdim{clivisalignmentmin}{0.3 cm}{1}



%%%%%%%%%%%%%%%%%
% vertical spaces
%%%%%%%%%%%%%%%%%

% first, we have two spaces for the chironomic signs
\gresetdim{abovesignsspace}{0.8 cm}{1}
\gresetdim{belowsignsspace}{0 cm}{1}
% the shift for the low choral sign and the high choral signs on totally free interlines
\gresetdim{lowchoralsignshift}{0.00911 cm}{1}
% the shift for the high choral sign
\gresetdim{highchoralsignshift}{-0.04556 cm}{1}
% the space for the translation
\gresetdim{translationheight}{0.5 cm}{1}
%the space above the lines
\gresetdim{spaceabovelines}{0.45576 cm plus 0.36461 cm minus 0.09114 cm}{1}
%the space between the lines and the bottom of the text
\gresetdim{spacelinestext}{0.60617 cm}{1}
%the space beneath the text
\gresetdim{spacebeneathtext}{0 cm}{1}
% height of the text above the note line
\gresetdim{abovelinestextraise}{-0.1 cm}{1}%
% height that is added at the top of the lines if there is text above the lines (it must be bigger than the text for it to be taken into consideration)
\gresetdim{abovelinestextheight}{0.3 cm}{1}%
% an additional shift you can give to the brace above the bars if you don't like it
\gresetdim{braceshift}{0 cm}{1}
% a shift you can give to the accentus above the curly brace
\gresetdim{curlybraceaccentusshift}{-0.05 cm}{1}

